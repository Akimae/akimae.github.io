{"title":"Vue记录- MVVM模型与数据代理","slug":"Vue/Vue04","date":"2023-02-21T12:11:47.619Z","updated":"2023-03-09T08:49:42.782Z","comments":true,"path":"api/articles/Vue/Vue04.json","photos":[],"link":"","excerpt":null,"covers":["https://s2.loli.net/2023/03/09/7tWJyOmqPVpUhQS.jpg","https://s2.loli.net/2023/03/09/yl7eQBL4YEFzSPs.png"],"content":"<h2 id=\"1-MVVM-模型\"><a href=\"#1-MVVM-模型\" class=\"headerlink\" title=\"1.MVVM 模型\"></a>1.MVVM 模型</h2><p><img src=\"https://s2.loli.net/2023/03/09/7tWJyOmqPVpUhQS.jpg\" alt=\"src_http_3A_2F_2Fimages2015.cnblogs.com_2Fblog_2F380281_2F201609_2F380281-20160907231648504-658215601.png_refer_http_3A_2F_2Fimages2015.cnblogs.jpg\"></p>\n<h4 id=\"MVVM模型\"><a href=\"#MVVM模型\" class=\"headerlink\" title=\"MVVM模型\"></a>MVVM模型</h4><p>M：模型 <strong>Model</strong>，data中的数据</p>\n<p>V：视图 <strong>View</strong>，模板代码</p>\n<p>VM：视图模型 <strong>ViewModel</strong>，Vue实例<br>观察发现</p>\n<p>data中所有的属性，最后都出现在了 <strong>vm</strong> 身上</p>\n<p>vm身上所有的属性 及Vue原型身上所有的属性，在 Vue模板中都可以直接使用</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\">&lt;!<span class=\"variable constant_\">DOCTYPE</span> html&gt;</span><br><span class=\"line\">&lt;html lang=&quot;en&quot;&gt;</span><br><span class=\"line\">&lt;head&gt;</span><br><span class=\"line\">    &lt;meta charset=&quot;UTF-8&quot;&gt;</span><br><span class=\"line\">    &lt;meta http-equiv=&quot;X-UA-Compatible&quot; content=&quot;IE=edge&quot;&gt;</span><br><span class=\"line\">    &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot;&gt;</span><br><span class=\"line\">    &lt;title&gt;mvvm&lt;/title&gt;</span><br><span class=\"line\">    &lt;script src=&quot;../js/vue.js&quot;&gt;&lt;/script&gt;</span><br><span class=\"line\">&lt;/head&gt;</span><br><span class=\"line\">&lt;body&gt;</span><br><span class=\"line\">  </span><br><span class=\"line\">    &lt;div id=&quot;root&quot;&gt;</span><br><span class=\"line\">        &lt;h2&gt;名称：&#123;&#123; name &#125;&#125;&lt;/h2&gt;</span><br><span class=\"line\">        &lt;h2&gt;学习：&#123;&#123; school &#125;&#125;&lt;/h2&gt;</span><br><span class=\"line\">        &lt;h2&gt;测试：&#123;&#123; $options &#125;&#125;&lt;/h2&gt;</span><br><span class=\"line\">    &lt;/div&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">    &lt;script&gt;</span><br><span class=\"line\">        Vue.config.productionTip = false</span><br><span class=\"line\">        new Vue(&#123;</span><br><span class=\"line\">            el: &#x27;#root&#x27;,</span><br><span class=\"line\">            data: &#123; </span><br><span class=\"line\">                name: &#x27;akimae&#x27;,</span><br><span class=\"line\">                school: &#x27;JNU&#x27;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;)</span><br><span class=\"line\">    &lt;/script&gt;</span><br><span class=\"line\">&lt;/body&gt;</span><br><span class=\"line\">&lt;/html&gt;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"2-Vue-中的数据代理\"><a href=\"#2-Vue-中的数据代理\" class=\"headerlink\" title=\"2.Vue 中的数据代理\"></a>2.Vue 中的数据代理</h2><h4 id=\"Object-defineproperty方法\"><a href=\"#Object-defineproperty方法\" class=\"headerlink\" title=\"Object.defineproperty方法\"></a>Object.defineproperty方法</h4><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">let</span> number = <span class=\"number\">18</span></span><br><span class=\"line\"><span class=\"keyword\">let</span> person = &#123;</span><br><span class=\"line\">  <span class=\"attr\">name</span>: <span class=\"string\">&#x27;张三&#x27;</span>,</span><br><span class=\"line\">  <span class=\"attr\">sex</span>: <span class=\"string\">&#x27;男&#x27;</span>,</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"title class_\">Object</span>.<span class=\"title function_\">defineProperty</span>(person, <span class=\"string\">&#x27;age&#x27;</span>, &#123;</span><br><span class=\"line\">  <span class=\"comment\">// value:18,</span></span><br><span class=\"line\">  <span class=\"comment\">// enumerable:true,\t\t// 控制属性是否可以枚举，默认值是false</span></span><br><span class=\"line\">  <span class=\"comment\">// writable:true,\t\t\t// 控制属性是否可以被修改，默认值是false</span></span><br><span class=\"line\">  <span class=\"comment\">// configurable:true\t// 控制属性是否可以被删除，默认值是false</span></span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"comment\">// 当有人读取person的age属性时，get函数(getter)就会被调用，且返回值就是age的值</span></span><br><span class=\"line\">  <span class=\"title function_\">get</span>(<span class=\"params\"></span>) &#123;</span><br><span class=\"line\">    <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">&#x27;有人读取age属性了&#x27;</span>)</span><br><span class=\"line\">    <span class=\"keyword\">return</span> number</span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"comment\">// 当有人修改person的age属性时，set函数(setter)就会被调用，且会收到修改的具体值</span></span><br><span class=\"line\">  <span class=\"title function_\">set</span>(<span class=\"params\">value</span>) &#123;</span><br><span class=\"line\">    <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">&#x27;有人修改了age属性，且值是&#x27;</span>, value)</span><br><span class=\"line\">    number = value</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"><span class=\"comment\">// console.log(Object.keys(person))</span></span><br><span class=\"line\"><span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(person)</span><br></pre></td></tr></table></figure>\n\n<p><strong>数据代理</strong>：通过一个对象代理对另一个对象中属性的操作（读&#x2F;写）</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">let</span> obj = &#123; <span class=\"attr\">x</span>: <span class=\"number\">100</span> &#125;</span><br><span class=\"line\"><span class=\"keyword\">let</span> obj2 = &#123; <span class=\"attr\">y</span>: <span class=\"number\">200</span> &#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"title class_\">Object</span>.<span class=\"title function_\">defineProperty</span>(obj2, <span class=\"string\">&#x27;x&#x27;</span>, &#123;</span><br><span class=\"line\">  <span class=\"title function_\">get</span>(<span class=\"params\"></span>) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> obj.<span class=\"property\">x</span></span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">  <span class=\"title function_\">set</span>(<span class=\"params\">value</span>) &#123;</span><br><span class=\"line\">    obj.<span class=\"property\">x</span> = value</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;)</span><br></pre></td></tr></table></figure>\n\n<p>1.Vue中的数据代理通过<strong>vm</strong>对象来代理<strong>data</strong>对象中属性的操作（读&#x2F;写）<br>2.Vue中数据代理的好处：更加方便的操作<strong>data</strong>中的数据<br>3.<strong>基本原理</strong><br>a.通过<strong>object.defineProperty()<strong>把</strong>data</strong>对象中所有属性添加到vm上<br>b.为每一个添加到<strong>vm</strong>上的属性，都指定一个 <strong>getter</strong>  <strong>setter</strong><br>c.在 <strong>getter</strong> <strong>setter</strong> 内部去操作（读&#x2F;写）<strong>data</strong> 中对应的属性</p>\n<p><img src=\"https://s2.loli.net/2023/03/09/yl7eQBL4YEFzSPs.png\" alt=\"20210811214920.png\"><br>Vue将<strong>data</strong>中的数据拷贝了一份到**_data<strong>属性中，又将_data里面的属性提到Vue实例中（如name），通过defineProperty实现数据代理，这样通过</strong>getter&#x2F;setter** 操作 name，进而操作**_data<strong>中的 name。而</strong>_data<strong>又对</strong>data**进行数据劫持来实现响应式。</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;!DOCTYPE html&gt;</span><br><span class=\"line\">&lt;html&gt;</span><br><span class=\"line\">  &lt;head&gt;</span><br><span class=\"line\">    &lt;meta charset=&quot;UTF-8&quot; /&gt;</span><br><span class=\"line\">    &lt;title&gt;Vue中的数据代理&lt;/title&gt;</span><br><span class=\"line\">    &lt;!-- 引入Vue --&gt;</span><br><span class=\"line\">    &lt;script type=&quot;text/javascript&quot; src=&quot;../js/vue.js&quot;&gt;&lt;/script&gt;</span><br><span class=\"line\">  &lt;/head&gt;</span><br><span class=\"line\">  &lt;body&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">    &lt;div id=&quot;root&quot;&gt;</span><br><span class=\"line\">      &lt;h2&gt;学校名称：&#123;&#123; name &#125;&#125;&lt;/h2&gt;</span><br><span class=\"line\">      &lt;h2&gt;学校地址：&#123;&#123; address &#125;&#125;&lt;/h2&gt;</span><br><span class=\"line\">    &lt;/div&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">    &lt;script type=&quot;text/javascript&quot;&gt;</span><br><span class=\"line\">      Vue.config.productionTip = false</span><br><span class=\"line\"></span><br><span class=\"line\">      const vm = new Vue(&#123;</span><br><span class=\"line\">        el: &#x27;#root&#x27;,</span><br><span class=\"line\">        data: &#123;</span><br><span class=\"line\">          name: &#x27;JNU&#x27;,</span><br><span class=\"line\">          address: &#x27;wuxi&#x27;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">      &#125;)</span><br><span class=\"line\">    &lt;/script&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">  &lt;/body&gt;</span><br><span class=\"line\">&lt;/html&gt;</span><br></pre></td></tr></table></figure>","categories":[{"name":"Vue","slug":"Vue","count":21,"path":"api/categories/Vue.json"}],"tags":[{"name":"Vue","slug":"Vue","count":21,"path":"api/tags/Vue.json"}]}