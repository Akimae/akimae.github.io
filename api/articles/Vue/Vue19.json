{"title":"Vue记录-20.activated deactivated与路由守卫","slug":"Vue/Vue19","date":"2023-03-10T06:16:15.278Z","updated":"2023-03-10T06:32:34.619Z","comments":true,"path":"api/articles/Vue/Vue19.json","photos":[],"link":"","excerpt":null,"covers":["https://s2.loli.net/2023/03/10/N4LJwcY5IxT8tKM.gif"],"content":"<h2 id=\"1-activated-deactivated\"><a href=\"#1-activated-deactivated\" class=\"headerlink\" title=\"1.activated deactivated\"></a>1.activated deactivated</h2><p><strong>activated</strong>和<strong>deactivated</strong>是路由组件所独有的两个钩子，用于捕获路由组件的激活状态</p>\n<p>具体使用<br>1.<strong>activated</strong>路由组件被激活时触发<br>2.<strong>deactivated</strong>路由组件失活时触发</p>\n<p><img src=\"https://s2.loli.net/2023/03/10/N4LJwcY5IxT8tKM.gif\" alt=\"手风琴动画.gif\"></p>\n<p> src&#x2F;pages&#x2F;News.vue</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;template&gt;</span><br><span class=\"line\">    &lt;ul&gt;</span><br><span class=\"line\">        &lt;li :style=&quot;&#123;opacity&#125;&quot;&gt;欢迎学习vue&lt;/li&gt;</span><br><span class=\"line\">        &lt;li&gt;news001 &lt;input type=&quot;text&quot;&gt;&lt;/li&gt;</span><br><span class=\"line\">        &lt;li&gt;news002 &lt;input type=&quot;text&quot;&gt;&lt;/li&gt;</span><br><span class=\"line\">        &lt;li&gt;news003 &lt;input type=&quot;text&quot;&gt;&lt;/li&gt;</span><br><span class=\"line\">    &lt;/ul&gt;</span><br><span class=\"line\">&lt;/template&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">&lt;script&gt;</span><br><span class=\"line\">    export default &#123;</span><br><span class=\"line\">        name:&#x27;News&#x27;,</span><br><span class=\"line\">        data()&#123;</span><br><span class=\"line\">            return&#123;</span><br><span class=\"line\">                opacity:1</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;,</span><br><span class=\"line\">        activated()&#123;</span><br><span class=\"line\">            console.log(&#x27;News组件被激活了&#x27;)</span><br><span class=\"line\">            this.timer = setInterval(() =&gt; &#123;</span><br><span class=\"line\">                this.opacity -= 0.01</span><br><span class=\"line\">                if(this.opacity &lt;= 0) this.opacity = 1</span><br><span class=\"line\">            &#125;,16)</span><br><span class=\"line\">        &#125;,</span><br><span class=\"line\">        deactivated()&#123;</span><br><span class=\"line\">            console.log(&#x27;News组件失活了&#x27;)</span><br><span class=\"line\">            clearInterval(this.timer)</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&lt;/script&gt;</span><br></pre></td></tr></table></figure>\n<h2 id=\"2-路由守卫\"><a href=\"#2-路由守卫\" class=\"headerlink\" title=\"2. 路由守卫\"></a>2. 路由守卫</h2><p><strong>作用</strong>：对路由进行权限控制<br><strong>分类</strong>：<strong>全局守卫、独享守卫、组件内守卫</strong> </p>\n<p>1.<strong>全局守卫</strong><br>meta路由源信息</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// 全局前置守卫：初始化时、每次路由切换前执行</span></span><br><span class=\"line\">router.<span class=\"title function_\">beforeEach</span>(<span class=\"function\">(<span class=\"params\">to,<span class=\"keyword\">from</span>,next</span>) =&gt;</span> &#123;</span><br><span class=\"line\">\t<span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">&#x27;beforeEach&#x27;</span>,to,<span class=\"keyword\">from</span>)</span><br><span class=\"line\">\t<span class=\"keyword\">if</span>(to.<span class=\"property\">meta</span>.<span class=\"property\">isAuth</span>)&#123; <span class=\"comment\">// 判断当前路由是否需要进行权限控制</span></span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span>(<span class=\"variable language_\">localStorage</span>.<span class=\"title function_\">getItem</span>(<span class=\"string\">&#x27;school&#x27;</span>) === <span class=\"string\">&#x27;atguigu&#x27;</span>)&#123; <span class=\"comment\">// 权限控制的具体规则</span></span><br><span class=\"line\">\t\t\t<span class=\"title function_\">next</span>()\t<span class=\"comment\">// 放行</span></span><br><span class=\"line\">\t\t&#125;<span class=\"keyword\">else</span>&#123;</span><br><span class=\"line\">\t\t\t<span class=\"title function_\">alert</span>(<span class=\"string\">&#x27;暂无权限查看&#x27;</span>)</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t&#125;<span class=\"keyword\">else</span>&#123;</span><br><span class=\"line\">\t\t<span class=\"title function_\">next</span>()\t<span class=\"comment\">// 放行</span></span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 全局后置守卫：初始化时、每次路由切换后执行</span></span><br><span class=\"line\">router.<span class=\"title function_\">afterEach</span>(<span class=\"function\">(<span class=\"params\">to,<span class=\"keyword\">from</span></span>) =&gt;</span> &#123;</span><br><span class=\"line\">\t<span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">&#x27;afterEach&#x27;</span>,to,<span class=\"keyword\">from</span>)</span><br><span class=\"line\">\t<span class=\"keyword\">if</span>(to.<span class=\"property\">meta</span>.<span class=\"property\">title</span>)&#123; </span><br><span class=\"line\">\t\t<span class=\"variable language_\">document</span>.<span class=\"property\">title</span> = to.<span class=\"property\">meta</span>.<span class=\"property\">title</span> <span class=\"comment\">//修改网页的title</span></span><br><span class=\"line\">\t&#125;<span class=\"keyword\">else</span>&#123;</span><br><span class=\"line\">\t\t<span class=\"variable language_\">document</span>.<span class=\"property\">title</span> = <span class=\"string\">&#x27;vue_test&#x27;</span></span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;)</span><br></pre></td></tr></table></figure>\n<p><strong>2.独享守卫</strong></p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"title function_\">beforeEnter</span>(<span class=\"params\">to,<span class=\"keyword\">from</span>,next</span>)&#123;</span><br><span class=\"line\">\t<span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">&#x27;beforeEnter&#x27;</span>,to,<span class=\"keyword\">from</span>)</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(<span class=\"variable language_\">localStorage</span>.<span class=\"title function_\">getItem</span>(<span class=\"string\">&#x27;school&#x27;</span>) === <span class=\"string\">&#x27;atguigu&#x27;</span>)&#123;</span><br><span class=\"line\">        <span class=\"title function_\">next</span>()</span><br><span class=\"line\">    &#125;<span class=\"keyword\">else</span>&#123;</span><br><span class=\"line\">        <span class=\"title function_\">alert</span>(<span class=\"string\">&#x27;暂无权限查看&#x27;</span>)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><strong>3.组件内守卫</strong></p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//进入守卫：通过路由规则，进入该组件时被调用</span></span><br><span class=\"line\">beforeRouteEnter (to, <span class=\"keyword\">from</span>, next) &#123;... <span class=\"title function_\">next</span>()&#125;,</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//离开守卫：通过路由规则，离开该组件时被调用</span></span><br><span class=\"line\">beforeRouteLeave (to, <span class=\"keyword\">from</span>, next) &#123;... <span class=\"title function_\">next</span>()&#125;,</span><br></pre></td></tr></table></figure>\n\n\n<h3 id=\"全局路由守卫\"><a href=\"#全局路由守卫\" class=\"headerlink\" title=\"全局路由守卫\"></a>全局路由守卫</h3><p>src&#x2F;router&#x2F;index.js</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//该文件专门用于创建整个应用的路由器</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> <span class=\"title class_\">VueRouter</span> <span class=\"keyword\">from</span> <span class=\"string\">&quot;vue-router&quot;</span>;</span><br><span class=\"line\"><span class=\"comment\">//引入组件</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> <span class=\"title class_\">Home</span> <span class=\"keyword\">from</span> <span class=\"string\">&#x27;../pages/Home&#x27;</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> <span class=\"title class_\">About</span> <span class=\"keyword\">from</span> <span class=\"string\">&#x27;../pages/About&#x27;</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> <span class=\"title class_\">News</span> <span class=\"keyword\">from</span> <span class=\"string\">&#x27;../pages/News&#x27;</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> <span class=\"title class_\">Message</span> <span class=\"keyword\">from</span> <span class=\"string\">&#x27;../pages/Message&#x27;</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> <span class=\"title class_\">Detail</span> <span class=\"keyword\">from</span> <span class=\"string\">&#x27;../pages/Detail&#x27;</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//创建一个路由器</span></span><br><span class=\"line\"><span class=\"keyword\">const</span> router = <span class=\"keyword\">new</span> <span class=\"title class_\">VueRouter</span>(&#123;</span><br><span class=\"line\">    <span class=\"attr\">routes</span>:[</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"attr\">name</span>:<span class=\"string\">&#x27;guanyv&#x27;</span>,</span><br><span class=\"line\">            <span class=\"attr\">path</span>:<span class=\"string\">&#x27;/about&#x27;</span>,</span><br><span class=\"line\">            <span class=\"attr\">component</span>:<span class=\"title class_\">About</span>,</span><br><span class=\"line\">            <span class=\"attr\">meta</span>:&#123;<span class=\"attr\">title</span>:<span class=\"string\">&#x27;关于&#x27;</span>&#125;</span><br><span class=\"line\">        &#125;,</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"attr\">name</span>:<span class=\"string\">&#x27;zhuye&#x27;</span>,</span><br><span class=\"line\">            <span class=\"attr\">path</span>:<span class=\"string\">&#x27;/home&#x27;</span>,</span><br><span class=\"line\">            <span class=\"attr\">component</span>:<span class=\"title class_\">Home</span>,</span><br><span class=\"line\">            <span class=\"attr\">meta</span>:&#123;<span class=\"attr\">title</span>:<span class=\"string\">&#x27;主页&#x27;</span>&#125;,</span><br><span class=\"line\">            <span class=\"attr\">children</span>:[</span><br><span class=\"line\">                &#123;</span><br><span class=\"line\">                    <span class=\"attr\">name</span>:<span class=\"string\">&#x27;xinwen&#x27;</span>,</span><br><span class=\"line\">                    <span class=\"attr\">path</span>:<span class=\"string\">&#x27;news&#x27;</span>,</span><br><span class=\"line\">                    <span class=\"attr\">component</span>:<span class=\"title class_\">News</span>,</span><br><span class=\"line\">                    <span class=\"attr\">meta</span>:&#123;<span class=\"attr\">isAuth</span>:<span class=\"literal\">true</span>,<span class=\"attr\">title</span>:<span class=\"string\">&#x27;新闻&#x27;</span>&#125;</span><br><span class=\"line\">                &#125;,</span><br><span class=\"line\">                &#123;</span><br><span class=\"line\">                    <span class=\"attr\">name</span>:<span class=\"string\">&#x27;xiaoxi&#x27;</span>,</span><br><span class=\"line\">                    <span class=\"attr\">path</span>:<span class=\"string\">&#x27;message&#x27;</span>,</span><br><span class=\"line\">                    <span class=\"attr\">component</span>:<span class=\"title class_\">Message</span>,</span><br><span class=\"line\">                    <span class=\"attr\">meta</span>:&#123;<span class=\"attr\">isAuth</span>:<span class=\"literal\">true</span>,<span class=\"attr\">title</span>:<span class=\"string\">&#x27;消息&#x27;</span>&#125;,</span><br><span class=\"line\">                    <span class=\"attr\">children</span>:[</span><br><span class=\"line\">                        &#123;</span><br><span class=\"line\">                            <span class=\"attr\">name</span>:<span class=\"string\">&#x27;xiangqing&#x27;</span>,</span><br><span class=\"line\">                            <span class=\"attr\">path</span>:<span class=\"string\">&#x27;detail&#x27;</span>,</span><br><span class=\"line\">                            <span class=\"attr\">component</span>:<span class=\"title class_\">Detail</span>,</span><br><span class=\"line\">                            <span class=\"attr\">meta</span>:&#123;<span class=\"attr\">isAuth</span>:<span class=\"literal\">true</span>,<span class=\"attr\">title</span>:<span class=\"string\">&#x27;详情&#x27;</span>&#125;,</span><br><span class=\"line\">                            <span class=\"title function_\">props</span>(<span class=\"params\">$route</span>)&#123;</span><br><span class=\"line\">                                <span class=\"keyword\">return</span> &#123;</span><br><span class=\"line\">                                    <span class=\"attr\">id</span>:$route.<span class=\"property\">query</span>.<span class=\"property\">id</span>,</span><br><span class=\"line\">                                    <span class=\"attr\">title</span>:$route.<span class=\"property\">query</span>.<span class=\"property\">title</span>,</span><br><span class=\"line\">                                &#125;</span><br><span class=\"line\">\t\t\t\t\t\t\t\t\t\t\t\t\t\t&#125;</span><br><span class=\"line\">                        &#125;</span><br><span class=\"line\">                    ]</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            ]</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    ]</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 全局前置路由守卫————初始化的时候、每次路由切换之前被调用</span></span><br><span class=\"line\">router.<span class=\"title function_\">beforeEach</span>(<span class=\"function\">(<span class=\"params\">to,<span class=\"keyword\">from</span>,next</span>) =&gt;</span> &#123;</span><br><span class=\"line\">    <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">&#x27;前置路由守卫&#x27;</span>,to,<span class=\"keyword\">from</span>)</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(to.<span class=\"property\">meta</span>.<span class=\"property\">isAuth</span>)&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(<span class=\"variable language_\">localStorage</span>.<span class=\"title function_\">getItem</span>(<span class=\"string\">&#x27;school&#x27;</span>)===<span class=\"string\">&#x27;atguigu&#x27;</span>)&#123;</span><br><span class=\"line\">            <span class=\"title function_\">next</span>()</span><br><span class=\"line\">        &#125;<span class=\"keyword\">else</span>&#123;</span><br><span class=\"line\">            <span class=\"title function_\">alert</span>(<span class=\"string\">&#x27;学校名不对，无权限查看！&#x27;</span>)</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;<span class=\"keyword\">else</span>&#123;</span><br><span class=\"line\">        <span class=\"title function_\">next</span>()</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 全局后置路由守卫————初始化的时候被调用、每次路由切换之后被调用</span></span><br><span class=\"line\">router.<span class=\"title function_\">afterEach</span>(<span class=\"function\">(<span class=\"params\">to,<span class=\"keyword\">from</span></span>)=&gt;</span>&#123;</span><br><span class=\"line\">\t<span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">&#x27;后置路由守卫&#x27;</span>,to,<span class=\"keyword\">from</span>)</span><br><span class=\"line\">\t<span class=\"variable language_\">document</span>.<span class=\"property\">title</span> = to.<span class=\"property\">meta</span>.<span class=\"property\">title</span> || <span class=\"string\">&#x27;硅谷系统&#x27;</span></span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 导出路由器</span></span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">default</span> router</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"独享路由守卫\"><a href=\"#独享路由守卫\" class=\"headerlink\" title=\"独享路由守卫\"></a>独享路由守卫</h3><p>src&#x2F;router&#x2F;index.js</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//该文件专门用于创建整个应用的路由器</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> <span class=\"title class_\">VueRouter</span> <span class=\"keyword\">from</span> <span class=\"string\">&quot;vue-router&quot;</span>;</span><br><span class=\"line\"><span class=\"comment\">//引入组件</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> <span class=\"title class_\">Home</span> <span class=\"keyword\">from</span> <span class=\"string\">&#x27;../pages/Home&#x27;</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> <span class=\"title class_\">About</span> <span class=\"keyword\">from</span> <span class=\"string\">&#x27;../pages/About&#x27;</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> <span class=\"title class_\">News</span> <span class=\"keyword\">from</span> <span class=\"string\">&#x27;../pages/News&#x27;</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> <span class=\"title class_\">Message</span> <span class=\"keyword\">from</span> <span class=\"string\">&#x27;../pages/Message&#x27;</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> <span class=\"title class_\">Detail</span> <span class=\"keyword\">from</span> <span class=\"string\">&#x27;../pages/Detail&#x27;</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//创建一个路由器</span></span><br><span class=\"line\"><span class=\"keyword\">const</span> router = <span class=\"keyword\">new</span> <span class=\"title class_\">VueRouter</span>(&#123;</span><br><span class=\"line\">    <span class=\"attr\">routes</span>:[</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"attr\">name</span>:<span class=\"string\">&#x27;guanyv&#x27;</span>,</span><br><span class=\"line\">            <span class=\"attr\">path</span>:<span class=\"string\">&#x27;/about&#x27;</span>,</span><br><span class=\"line\">            <span class=\"attr\">component</span>:<span class=\"title class_\">About</span>,</span><br><span class=\"line\">            <span class=\"attr\">meta</span>:&#123;<span class=\"attr\">title</span>:<span class=\"string\">&#x27;关于&#x27;</span>&#125;</span><br><span class=\"line\">        &#125;,</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"attr\">name</span>:<span class=\"string\">&#x27;zhuye&#x27;</span>,</span><br><span class=\"line\">            <span class=\"attr\">path</span>:<span class=\"string\">&#x27;/home&#x27;</span>,</span><br><span class=\"line\">            <span class=\"attr\">component</span>:<span class=\"title class_\">Home</span>,</span><br><span class=\"line\">            <span class=\"attr\">meta</span>:&#123;<span class=\"attr\">title</span>:<span class=\"string\">&#x27;主页&#x27;</span>&#125;,</span><br><span class=\"line\">            <span class=\"attr\">children</span>:[</span><br><span class=\"line\">                &#123;</span><br><span class=\"line\">                    <span class=\"attr\">name</span>:<span class=\"string\">&#x27;xinwen&#x27;</span>,</span><br><span class=\"line\">                    <span class=\"attr\">path</span>:<span class=\"string\">&#x27;news&#x27;</span>,</span><br><span class=\"line\">                    <span class=\"attr\">component</span>:<span class=\"title class_\">News</span>,</span><br><span class=\"line\">                    <span class=\"attr\">meta</span>:&#123;<span class=\"attr\">title</span>:<span class=\"string\">&#x27;新闻&#x27;</span>&#125;,</span><br><span class=\"line\">                    <span class=\"comment\">// 独享守卫，特定路由切换之后被调用</span></span><br><span class=\"line\">                    <span class=\"title function_\">beforeEnter</span>(<span class=\"params\">to,<span class=\"keyword\">from</span>,next</span>)&#123;</span><br><span class=\"line\">                        <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">&#x27;独享路由守卫&#x27;</span>,to,<span class=\"keyword\">from</span>)</span><br><span class=\"line\">                        <span class=\"keyword\">if</span>(<span class=\"variable language_\">localStorage</span>.<span class=\"title function_\">getItem</span>(<span class=\"string\">&#x27;school&#x27;</span>) === <span class=\"string\">&#x27;atguigu&#x27;</span>)&#123;</span><br><span class=\"line\">                            <span class=\"title function_\">next</span>()</span><br><span class=\"line\">                        &#125;<span class=\"keyword\">else</span>&#123;</span><br><span class=\"line\">                            <span class=\"title function_\">alert</span>(<span class=\"string\">&#x27;暂无权限查看&#x27;</span>)</span><br><span class=\"line\">                        &#125;</span><br><span class=\"line\">                    &#125;</span><br><span class=\"line\">                &#125;,</span><br><span class=\"line\">                &#123;</span><br><span class=\"line\">                    <span class=\"attr\">name</span>:<span class=\"string\">&#x27;xiaoxi&#x27;</span>,</span><br><span class=\"line\">                    <span class=\"attr\">path</span>:<span class=\"string\">&#x27;message&#x27;</span>,</span><br><span class=\"line\">                    <span class=\"attr\">component</span>:<span class=\"title class_\">Message</span>,</span><br><span class=\"line\">                    <span class=\"attr\">meta</span>:&#123;<span class=\"attr\">title</span>:<span class=\"string\">&#x27;消息&#x27;</span>&#125;,</span><br><span class=\"line\">                    <span class=\"attr\">children</span>:[</span><br><span class=\"line\">                        &#123;</span><br><span class=\"line\">                            <span class=\"attr\">name</span>:<span class=\"string\">&#x27;xiangqing&#x27;</span>,</span><br><span class=\"line\">                            <span class=\"attr\">path</span>:<span class=\"string\">&#x27;detail&#x27;</span>,</span><br><span class=\"line\">                            <span class=\"attr\">component</span>:<span class=\"title class_\">Detail</span>,</span><br><span class=\"line\">                            <span class=\"attr\">meta</span>:&#123;<span class=\"attr\">title</span>:<span class=\"string\">&#x27;详情&#x27;</span>&#125;,</span><br><span class=\"line\">                            <span class=\"title function_\">props</span>(<span class=\"params\">$route</span>)&#123;</span><br><span class=\"line\">                                <span class=\"keyword\">return</span> &#123;</span><br><span class=\"line\">                                    <span class=\"attr\">id</span>:$route.<span class=\"property\">query</span>.<span class=\"property\">id</span>,</span><br><span class=\"line\">                                    <span class=\"attr\">title</span>:$route.<span class=\"property\">query</span>.<span class=\"property\">title</span>,</span><br><span class=\"line\">                                &#125;</span><br><span class=\"line\">                            &#125;</span><br><span class=\"line\">                        &#125;</span><br><span class=\"line\">                    ]</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            ]</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    ]</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//全局后置路由守卫————初始化的时候被调用、每次路由切换之后被调用</span></span><br><span class=\"line\">router.<span class=\"title function_\">afterEach</span>(<span class=\"function\">(<span class=\"params\">to,<span class=\"keyword\">from</span></span>)=&gt;</span>&#123;</span><br><span class=\"line\">\t<span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">&#x27;后置路由守卫&#x27;</span>,to,<span class=\"keyword\">from</span>)</span><br><span class=\"line\">\t<span class=\"variable language_\">document</span>.<span class=\"property\">title</span> = to.<span class=\"property\">meta</span>.<span class=\"property\">title</span> || <span class=\"string\">&#x27;硅谷系统&#x27;</span></span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//导出路由器</span></span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">default</span> router</span><br></pre></td></tr></table></figure>\n<h3 id=\"组件内路由守卫\"><a href=\"#组件内路由守卫\" class=\"headerlink\" title=\"组件内路由守卫\"></a>组件内路由守卫</h3><p>src&#x2F;pages&#x2F;About.vue</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;template&gt;</span><br><span class=\"line\">    <span class=\"language-xml\"><span class=\"tag\">&lt;<span class=\"name\">h2</span>&gt;</span>我是About组件的内容<span class=\"tag\">&lt;/<span class=\"name\">h2</span>&gt;</span></span></span><br><span class=\"line\">&lt;/template&gt;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"language-xml\"><span class=\"tag\">&lt;<span class=\"name\">script</span>&gt;</span><span class=\"language-javascript\"></span></span></span><br><span class=\"line\"><span class=\"language-javascript\"><span class=\"language-xml\">    <span class=\"keyword\">export</span> <span class=\"keyword\">default</span> &#123;</span></span></span><br><span class=\"line\"><span class=\"language-javascript\"><span class=\"language-xml\">        <span class=\"attr\">name</span>:<span class=\"string\">&#x27;About&#x27;</span>,</span></span></span><br><span class=\"line\"><span class=\"language-javascript\"><span class=\"language-xml\">        <span class=\"comment\">// 通过路由规则，离开该组件时被调用</span></span></span></span><br><span class=\"line\"><span class=\"language-javascript\"><span class=\"language-xml\">        beforeRouteEnter (to, <span class=\"keyword\">from</span>, next) &#123;</span></span></span><br><span class=\"line\"><span class=\"language-javascript\"><span class=\"language-xml\">            <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">&#x27;About--beforeRouteEnter&#x27;</span>,to,<span class=\"keyword\">from</span>)</span></span></span><br><span class=\"line\"><span class=\"language-javascript\"><span class=\"language-xml\">            <span class=\"keyword\">if</span>(<span class=\"variable language_\">localStorage</span>.<span class=\"title function_\">getItem</span>(<span class=\"string\">&#x27;school&#x27;</span>)===<span class=\"string\">&#x27;atguigu&#x27;</span>)&#123;</span></span></span><br><span class=\"line\"><span class=\"language-javascript\"><span class=\"language-xml\">                <span class=\"title function_\">next</span>()</span></span></span><br><span class=\"line\"><span class=\"language-javascript\"><span class=\"language-xml\">            &#125;<span class=\"keyword\">else</span>&#123;</span></span></span><br><span class=\"line\"><span class=\"language-javascript\"><span class=\"language-xml\">                <span class=\"title function_\">alert</span>(<span class=\"string\">&#x27;名称不对，无权限查看！&#x27;</span>)</span></span></span><br><span class=\"line\"><span class=\"language-javascript\"><span class=\"language-xml\">            &#125;</span></span></span><br><span class=\"line\"><span class=\"language-javascript\"><span class=\"language-xml\">        &#125;,</span></span></span><br><span class=\"line\"><span class=\"language-javascript\"><span class=\"language-xml\">        <span class=\"comment\">// 通过路由规则，离开该组件时被调用</span></span></span></span><br><span class=\"line\"><span class=\"language-javascript\"><span class=\"language-xml\">        beforeRouteLeave (to, <span class=\"keyword\">from</span>, next) &#123;</span></span></span><br><span class=\"line\"><span class=\"language-javascript\"><span class=\"language-xml\">            <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">&#x27;About--beforeRouteLeave&#x27;</span>,to,<span class=\"keyword\">from</span>)</span></span></span><br><span class=\"line\"><span class=\"language-javascript\"><span class=\"language-xml\">            <span class=\"title function_\">next</span>()</span></span></span><br><span class=\"line\"><span class=\"language-javascript\"><span class=\"language-xml\">        &#125;</span></span></span><br><span class=\"line\"><span class=\"language-javascript\"><span class=\"language-xml\">    &#125;</span></span></span><br><span class=\"line\"><span class=\"language-javascript\"><span class=\"language-xml\"></span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"3-路由器的两种工作模式\"><a href=\"#3-路由器的两种工作模式\" class=\"headerlink\" title=\"3.路由器的两种工作模式\"></a>3.路由器的两种工作模式</h2><p>1.对于一个<em>url</em>来说，什么是<em>hash</em>值？<br> <strong>#及其后面的内容就是<em>hash</em>值</strong></p>\n<p>2.hash值不会包含在HTTP请求中，即：hash值不会带给服务器 </p>\n<p>3.<strong>hash</strong>模式<br>a.地址中永远带着#号，不美观<br>b.若以后将地址通过第三方手机app分享，若app校验严格，则地址会被标记为不合法<br>c.兼容性较好</p>\n<p>4.<strong>history</strong>模式<br>a.地址干净，美观<br>b.兼容性和hash模式相比略差<br>c.应用部署上线时需要后端人员支持，解决刷新页面服务端404的问题</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> router =  <span class=\"keyword\">new</span> <span class=\"title class_\">VueRouter</span>(&#123;</span><br><span class=\"line\">\t<span class=\"attr\">mode</span>:<span class=\"string\">&#x27;history&#x27;</span>,</span><br><span class=\"line\">\t<span class=\"attr\">routes</span>:[...]</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">default</span> router</span><br></pre></td></tr></table></figure>","categories":[{"name":"Vue","slug":"Vue","count":20,"path":"api/categories/Vue.json"}],"tags":[{"name":"Vue","slug":"Vue","count":20,"path":"api/tags/Vue.json"}]}